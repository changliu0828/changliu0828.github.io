<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="3100px" height="2250px" viewBox="-0.5 -0.5 3100 2250" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-291-163-1159-114-0"><rect x="291" y="163" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-293-1159-114-0"><rect x="291" y="293" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-423-1159-114-0"><rect x="291" y="423" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-553-1159-114-0"><rect x="291" y="553" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-683-1159-114-0"><rect x="291" y="683" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-813-1159-114-0"><rect x="291" y="813" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-943-1159-114-0"><rect x="291" y="943" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1073-1159-114-0"><rect x="291" y="1073" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1203-1159-114-0"><rect x="291" y="1203" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1333-1159-114-0"><rect x="291" y="1333" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1463-1159-114-0"><rect x="291" y="1463" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1593-1159-114-0"><rect x="291" y="1593" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1723-1159-114-0"><rect x="291" y="1723" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1853-1159-114-0"><rect x="291" y="1853" width="1159" height="114"/></clipPath><clipPath id="mx-clip-291-1983-1159-114-0"><rect x="291" y="1983" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-453-1159-394-0"><rect x="1908" y="453" width="1159" height="394"/></clipPath><clipPath id="mx-clip-1908-888-1159-114-0"><rect x="1908" y="888" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1018-1159-114-0"><rect x="1908" y="1018" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1148-1159-114-0"><rect x="1908" y="1148" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1278-1159-114-0"><rect x="1908" y="1278" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1713-1159-114-0"><rect x="1908" y="1713" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1843-1159-114-0"><rect x="1908" y="1843" width="1159" height="114"/></clipPath><clipPath id="mx-clip-1908-1973-1159-114-0"><rect x="1908" y="1973" width="1159" height="114"/></clipPath></defs><g><path d="M 1880 650 L 1685 650 L 1685 124.8 L 1526.35 124.8" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1500.1 124.8 L 1535.1 107.3 L 1526.35 124.8 L 1535.1 142.3 Z" fill="#000000" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="all"/><path d="M 1477.5 195 L 2487.5 195 L 2487.5 283.16" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2487.5 309.41 L 2470 274.41 L 2487.5 283.16 L 2505 274.41 Z" fill="#000000" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="all"/><path d="M 0 295 L 0 165 L 1215 165 L 1215 295" fill="#6666ff" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="all"/><path d="M 0 295 L 0 2245 L 1215 2245 L 1215 295" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="295" width="1215" height="130" fill="#66b2ff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="425" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="555" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="685" width="1215" height="130" fill="#004c99" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="815" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="945" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1075" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1205" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1335" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1465" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1595" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1725" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1855" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="1985" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="0" y="2115" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><path d="M 130 215 L 130 85 L 1345 85 L 1345 215" fill="#6666ff" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><path d="M 130 215 L 130 2165 L 1345 2165 L 1345 215" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><rect x="130" y="215" width="1215" height="130" fill="#66b2ff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="345" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="475" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="605" width="1215" height="130" fill="#004c99" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="735" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="865" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="995" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1125" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1255" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1385" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1515" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1645" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1775" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="1905" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><rect x="130" y="2035" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><path d="M 262.5 130 L 262.5 0 L 1477.5 0 L 1477.5 130" fill="#6666ff" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><path d="M 262.5 130 L 262.5 2080 L 1477.5 2080 L 1477.5 130" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="60px"><text x="869.5" y="89.5">stCoRoutine_t</text></g><rect x="262.5" y="130" width="1215" height="130" fill="#66b2ff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-163-1159-114-0)" font-size="60px"><text x="292" y="219.5">stCoRoutineEnv_t *env; //指向协程运行环境</text></g><rect x="262.5" y="260" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-293-1159-114-0)" font-size="60px"><text x="292" y="349.5">pfn_co_routine_t pfn; //指向执行函数</text></g><rect x="262.5" y="390" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-423-1159-114-0)" font-size="60px"><text x="292" y="479.5">void *arg; //执行函数参数</text></g><rect x="262.5" y="520" width="1215" height="130" fill="#004c99" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#FFFFFF" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-553-1159-114-0)" font-size="60px"><text x="292" y="609.5">coctx_t ctx; //上下文</text></g><rect x="262.5" y="650" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-683-1159-114-0)" font-size="60px"><text x="292" y="739.5">char cStart; //是否开始</text></g><rect x="262.5" y="780" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-813-1159-114-0)" font-size="60px"><text x="292" y="869.5">char cEnd; //是否完成</text></g><rect x="262.5" y="910" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-943-1159-114-0)" font-size="60px"><text x="292" y="999.5">char cIsMain; //是否为主协程</text></g><rect x="262.5" y="1040" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1073-1159-114-0)" font-size="60px"><text x="292" y="1129.5">char cEnableSysHook; //是否hook系统调用</text></g><rect x="262.5" y="1170" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1203-1159-114-0)" font-size="60px"><text x="292" y="1259.5">char cIsShareStack; //是否开启共享栈</text></g><rect x="262.5" y="1300" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1333-1159-114-0)" font-size="60px"><text x="292" y="1389.5">void *pvEnv;</text></g><rect x="262.5" y="1430" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1463-1159-114-0)" font-size="60px"><text x="292" y="1519.5">stStackMem_t* stack_mem; //栈指针</text></g><rect x="262.5" y="1560" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1593-1159-114-0)" font-size="60px"><text x="292" y="1649.5">char* stack_sp; //共享栈顶</text></g><rect x="262.5" y="1690" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1723-1159-114-0)" font-size="60px"><text x="292" y="1779.5">unsigned int save_size; //共享栈大小</text></g><rect x="262.5" y="1820" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1853-1159-114-0)" font-size="60px"><text x="292" y="1909.5">char* save_buffer; //指向保存当前栈位置</text></g><rect x="262.5" y="1950" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-291-1983-1159-114-0)" font-size="60px"><text x="292" y="2039.5">stCoSpec_t aSpec[1024];</text></g><path d="M 1880 445 L 1880 315 L 3095 315 L 3095 445" fill="#66b2ff" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1880 445 L 1880 1375 L 3095 1375 L 3095 445" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="60px"><text x="2487" y="404.5">stCoRoutineEnv_t</text></g><rect x="1880" y="445" width="1215" height="410" fill="#6666ff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-453-1159-394-0)" font-size="60px"><text x="1909.5" y="639.5">stCoRoutine_t *pCallStack[ 128 ];</text><text x="1909.5" y="709.5">//所有协程调用栈</text></g><rect x="1880" y="855" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-888-1159-114-0)" font-size="60px"><text x="1909.5" y="944.5">int iCallStackSize; //栈顶索引</text></g><rect x="1880" y="985" width="1215" height="130" fill="#003333" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#FFFFFF" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1018-1159-114-0)" font-size="60px"><text x="1909.5" y="1074.5">stCoEpoll_t *pEpoll; //epoll封装</text></g><rect x="1880" y="1115" width="1215" height="130" fill="#6666ff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1148-1159-114-0)" font-size="60px"><text x="1909.5" y="1204.5">stCoRoutine_t* pending_co; //带切换协程</text></g><rect x="1880" y="1245" width="1215" height="130" fill="#6666ff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1278-1159-114-0)" font-size="60px"><text x="1909.5" y="1334.5">stCoRoutine_t* occupy_co; //现共享栈协程</text></g><path d="M 1880 1680 L 1880 1550 L 3095 1550 L 3095 1680" fill="#004c99" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1880 1680 L 1880 2070 L 3095 2070 L 3095 1680" fill="none" stroke="#000000" stroke-width="5" stroke-miterlimit="10" pointer-events="none"/><g fill="#FFFFFF" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="60px"><text x="2487" y="1639.5">coctx_t</text></g><rect x="1880" y="1680" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1713-1159-114-0)" font-size="60px"><text x="1909.5" y="1769.5">void *regs[]</text></g><rect x="1880" y="1810" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1843-1159-114-0)" font-size="60px"><text x="1909.5" y="1899.5">size_t ss_size</text></g><rect x="1880" y="1940" width="1215" height="130" fill="#ffffff" stroke="#000000" stroke-width="5" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1908-1973-1159-114-0)" font-size="60px"><text x="1909.5" y="2029.5">char *ss_sp</text></g></g></svg>